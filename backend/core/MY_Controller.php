<?php/** * Created by PhpStorm. * User: asusa * Date: 2018/3/27/0027 * Author: Cary.He * Contact QQ  : 373889161($S$-Memory) * email: 373889161@qq.com * Time: 13:55 */namespace backend\core;use backend\models\Contact;use yii\web\Controller;use backend\models\Navigation;use backend\models\Navisort;use backend\models\Article;use backend\models\Sort;use backend\models\Admin;use backend\models\Goods;use backend\models\Category;use yii\data\Pagination;date_default_timezone_set('PRC');class MY_Controller extends Controller{    public function init()    {        if(\Helpers::resession('SESSION_NAME'))        {            //return $this->redirect('index');            //echo '登录成功！';        }else{            return $this->redirect('login');            //echo '未登录！';        }    }    /**     * @param $id     * @return mixed     * @throws NotFoundHttpException     * 根据ID返回查询导航信息     * 导航信息     */    public function findModel($id)    {        if (($model = Navigation::findOne($id)) !== null)        {            return $model;        }        else        {            throw new NotFoundHttpException('The requested page does not exist.');        }    }    /**     * @param $id     * @return null|static     * 根据ID返回查询的文章信息     */    protected function findArticle($id)    {        if (($model = Article::findOne($id)) !== null) {            return $model;        } else {            throw new NotFoundHttpException('The requested page does not exist.');        }    }    /**     * @param $id     * @return mixed     * 根据ID返回查询文章的分类信息     */    protected function findSort($id)    {        if (($model = Sort::findOne($id)) !== null) {            return $model;        } else {            Yii::$app->session->setFlash('success','参数错误!');        }    }    /**     * @param $id     * @return null|\yii\web\Response|static     * @throws NotFoundHttpException     * 根据ID返回查询分类信息     * 导航分类信息     */    protected function findNavsort($id)    {        if (($model = Navisort::findOne($id)) !== null)        {            return $model;        }        else        {            throw new NotFoundHttpException('The requested page does not exist.');        }    }    /**     * @param $id     * @return null|static     * 根据ID返回管理员信息     */    protected function findAdmin($id)    {        if (($model = Admin::findOne($id)) !== null) {            return $model;        } else {            throw new NotFoundHttpException('The requested page does not exist.');        }    }    /**     * @param $id     * @return mixed     * @throws NotFoundHttpException     * 根据ID返回查询内容     */    protected function findGoods($id)    {        if (($model = Goods::findOne($id)) !== null)        {            return $model;        } else {            throw new NotFoundHttpException('The requested page does not exist.');        }    }    /**     * @param $id     * @return mixed     * @throws NotFoundHttpException     * 根据ID返回查询内容     */    protected function findCategory($id)    {        if (($model = Category::findOne($id)) !== null) {            return $model;        }        else        {            Yii::$app->session->setFlash('success','参数错误!');        }    }    /**     * @param $id     * @return null|static     * 根据ID返回对应留言信息     */    protected function findContact($id)    {        if (($model = Contact::findOne($id)) !== null) {            return $model;        } else {            throw new NotFoundHttpException('The requested page does not exist.');        }    }    /**     * @param $query  数据表     * @param int $num 显示的数量     * @return Pagination     * 分页函数     */    public function Page($query,$num=10)    {        $pa = new Pagination([            'defaultPageSize' => $num,//设置显示数量            'totalCount' => $query->count(),//总记录            'pageParam' => 'p', //URL参数设置为p            //'route' => false,  //隐藏路由            'validatePage' => false,        ]);        return $pa;    }}